{% extends 'base.html' %}
{% load static %}
{% block title %}Trang chủ - CareerPath{% endblock %}

{% block content %}
<section class="hero">
    <!-- Optional: Add a subtle pattern overlay instead of just darken if desired -->
    <div class="hero-overlay-pattern"></div>
    <div class="hero-darken"></div>
    <div class="container hero-content"> <!-- Use container -->
        <h1>ĐI <span class="highlight-yellow">ĐÚNG</span> ĐƯỜNG<br>TƯƠNG LAI TỎA SÁNG</h1>
        <p class="lead">“Bạn đang băn khoăn về ngành học, định hướng nghề nghiệp hay tự hỏi mình phù hợp với ngành nào? Hãy để CareerPath đồng hành cùng bạn! Khám phá bản thân, tìm hiểu xu hướng và xây dựng lộ trình sự nghiệp vững chắc.”</p>
        <a href="#info" class="btn btn-lg btn-primary hero-cta"> Bắt đầu khám phá <i class="fas fa-arrow-down ms-2"></i></a> 
    </div>
</section>

<section id="info" class="info-section section-padding"> <!-- Added common padding class -->
    <div class="container">
        <div class="row align-items-center g-5"> <!-- Bootstrap row with gap -->
            <div class="col-lg-5 info-left">
                 <div class="image-wrapper shadow-lg"> <!-- Wrapper for shadow -->
                    <img src="{% static 'images/test.jpg' %}" alt="Làm bài trắc nghiệm trực tuyến" class="img-fluid rounded"> <!-- img-fluid and rounded -->
                 </div>
            </div>
            <div class="col-lg-6 info-right ms-lg-5">
                <h2 class="section-title"><span class="highlight-green">HIỂU BẢN THÂN</span>,<br> CHỌN ĐÚNG NGHỀ</h2>
                <p class="section-subtitle">Khám phá bản thân qua các bài kiểm tra tính cách và sở thích. Nhận ngay kết quả phân tích chi tiết, giúp bạn hiểu rõ điểm mạnh, điểm yếu và định hướng nghề nghiệp phù hợp nhất.</p>
                <button type="button" class="btn btn-secondary cta-button" data-bs-toggle="modal" data-bs-target="#chooseUserTypeModal">
                    Làm bài Test ngay! <i class="fas fa-pen-alt ms-2"></i>
                </button>
            </div>
        </div>
    </div>
</section>

<!-- =============================================================== -->
<!-- === BẮT ĐẦU MÃ HTML CỦA MODAL (PHIÊN BẢN VIBRANT & ALIVE) === -->
<!-- =============================================================== -->
<div class="modal fade" id="chooseUserTypeModal" tabindex="-1" aria-labelledby="chooseUserTypeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg"> 
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="chooseUserTypeModalLabel">Chọn bài Test dành cho bạn</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4 p-md-5">
                <div class="row g-4">
                    <!-- Ô Lựa Chọn 1: Học Sinh -->
                    <div class="col-md-6">
                        <a href="{% url 'quiz_highschool:gioi_thieu' %}" class="choice-card choice-card-student">
                            <i class="fas fa-user-graduate choice-icon"></i>
                            <h3 class="choice-title">Học Sinh</h3>
                        </a>
                    </div>

                    <!-- Ô Lựa Chọn 2: Sinh Viên -->
                    <div class="col-md-6">
                        <!-- LƯU Ý: Thay thế '#' bằng URL cho bài test của sinh viên -->
                        <a href="{% url 'quiz_university:gioi_thieu_u' %}" class="choice-card choice-card-university">
                            <i class="fas fa-user-tie choice-icon"></i>
                            <h3 class="choice-title">Sinh Viên</h3>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- === KẾT THÚC MÃ HTML CỦA MODAL === -->

<section class="trends-section section-padding bg-light-gray">
    <div class="container">
        <div class="row align-items-center justify-content-between gy-5"> <!-- Use row and align items -->

            <!-- Text Column -->
            <div class="col-lg-6 text-center text-lg-start"> <!-- Text aligned left on large screens -->
                <h2 class="section-title mb-3">BẮT KỊP <span class="highlight-yellow">XU HƯỚNG</span>,<br> ĐÓN ĐẦU CƠ HỘI</h2>
                <p class="section-subtitle mb-4">Cập nhật thông tin mới nhất về thị trường lao động, mức lương các ngành nghề và nhu cầu nhân lực tương lai để đưa ra quyết định sáng suốt.</p>
                <a href="{% url 'trend:trend' %}" class="btn btn-primary trends-button">Tìm hiểu thêm <i class="fas fa-chart-line ms-2"></i></a>
            </div>

            <!-- Image Column -->
            <div class="col-lg-5"> <!-- Slightly smaller column for image can look nice -->
                 <div class="trends-image-container">
                    <img src="{% static 'images/trend.jpg' %}" alt="Phân tích xu hướng nghề nghiệp" class="img-fluid rounded shadow-lg"> <!-- Added shadow-lg for more emphasis -->
                </div>
            </div>

        </div>
    </div>
</section>

{% comment %} =============================================================== {% endcomment %}
{% comment %} ===   BẮT ĐẦU PHẦN ĐÁNH GIÁ (KẾT HỢP ICON & SHAPES)          === {% endcomment %}
{% comment %} =============================================================== {% endcomment %}
<section class="section-padding reviews-section-marquee" id="reviews">
    
    <!-- THÊM LẠI: "Sân khấu" cho các hình khối nền -->
    <div class="reviews-bg-shapes" aria-hidden="true">
        <span class="shape shape-1"></span>
        <span class="shape shape-2"></span>
        <span class="shape shape-3"></span>
    </div>

    <div class="container text-center">
        <!-- TIÊU ĐỀ -->
        <h2 class="section-title mb-4">Người dùng nói gì về <span class="highlight-green">CareerPath?</span></h2>
        <p class="section-subtitle mx-auto" style="max-width: 650px;">
            Lắng nghe những chia sẻ chân thực từ những người đã trải nghiệm và tìm thấy định hướng sự nghiệp của mình cùng chúng tôi.
        </p>

        <!-- DẢI PHÂN CÁCH VỚI ICON -->
        <div class="title-separator">
            <i class="fas fa-quote-left"></i>
        </div>
    </div>

    <div class="reviews-carousel-wrapper">
        <div class="swiper reviews-swiper-marquee">
            <div class="swiper-wrapper">
                
                {# === LẶP LẠI DANH SÁCH 2 LẦN (NỘI DUNG GIỮ NGUYÊN) === #}
                {% for fb in top_reviews %}
                <div class="swiper-slide">
                    <div class="review-card-item card">
                        <div class="card-body d-flex flex-column">
                            <div class="review-card-header d-flex align-items-center mb-3">
                                <i class="fas fa-user-circle fa-3x me-3 text-secondary-green"></i>
                                <div class="review-user-info">
                                    <strong class="d-block text-dark-emphasis">{{ fb.user.username }}</strong>
                                    <small class="text-muted">{{ fb.created_at|date:"d/m/Y" }}</small>
                                </div>
                            </div>
                            <div class="review-card-rating mb-3 text-warning">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= fb.rating %}★{% else %}☆{% endif %}
                                {% endfor %}
                            </div>
                            <p class="review-card-comment mb-0 flex-grow-1">
                                “{{ fb.comment|default:"(Người dùng không để lại bình luận)"|truncatewords:30 }}”
                            </p>
                        </div>
                    </div>
                </div>
                {% endfor %}

            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const swiperMarquee = new Swiper('.reviews-swiper-marquee', {
    loop: true,
    slidesPerView: 'auto',
    spaceBetween: 30,
    

    // Marquee mượt
    freeMode: true,
    freeModeMomentum: false,

    // Autoplay liên tục như băng chuyền
    speed: 6000,
    autoplay: {
      delay: 0,                 // chạy liên tục
      disableOnInteraction: false // tự quản lý pause/resume
    },

    // Cho phép kéo
    allowTouchMove: true,
  });

  const wrapper = document.querySelector('.reviews-carousel-wrapper');
  if (!wrapper) return;

  let isPaused = false;

  function pause() {
    if (isPaused) return;
    isPaused = true;
    swiperMarquee.autoplay.stop();
    wrapper.classList.add('is-paused');
  }

  function resume() {
    if (!isPaused) return;
    isPaused = false;
    // Không dùng slideNext(0), không đổi delay — tránh giật
    swiperMarquee.autoplay.start();
    wrapper.classList.remove('is-paused');
  }

  // Click để pause/resume (tùy bạn có muốn giữ behavior này không)
  wrapper.addEventListener('click', () => {
    isPaused ? resume() : pause();
  });

  // Khi người dùng bắt đầu kéo → dừng
  swiperMarquee.on('touchStart', () => {
    pause();
  });

  // Khi thả tay → đợi một nhịp cho quán tính dừng hẳn rồi chạy lại
  swiperMarquee.on('touchEnd', () => {
    setTimeout(resume, 200);
  });

  // Hover (desktop) → tạm dừng, rời chuột → chạy tiếp (tuỳ chọn)
  wrapper.addEventListener('pointerenter', pause);
  wrapper.addEventListener('pointerleave', resume);
});

  
</script>



{% endblock %}